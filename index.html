<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ­·å²æœ¬ç›Šæ¯”åˆ†æå ±å‘Š | Historical P/E Ratio Analysis</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --success-color: #22c55e;
            --danger-color: #ef4444;
            --warning-color: #f97316;
            --bg-primary: #ffffff;
            --bg-secondary: #f5f7fa;
            --text-primary: #333333;
            --text-secondary: #666666;
            --border-color: #e0e0e0;
        }
        
        body.dark-mode {
            --bg-primary: #1e1e1e;
            --bg-secondary: #2d2d2d;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --border-color: #444444;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--text-primary);
            transition: background 0.3s ease;
        }
        
        body.dark-mode {
            background: linear-gradient(135deg, #1e1e1e 0%, #2d2d2d 100%);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .theme-toggle {
            padding: 8px 16px;
            border: none;
            background-color: var(--primary-color);
            color: white;
            cursor: pointer;
            border-radius: 5px;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }
        
        .theme-toggle:hover {
            opacity: 0.8;
        }
        
        .language-select {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            background-color: var(--bg-primary);
            color: var(--text-primary);
            cursor: pointer;
            border-radius: 5px;
            font-size: 0.9em;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            font-size: 1.2em;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }
        
        .meta {
            font-size: 0.9em;
            color: var(--text-secondary);
        }
        
        .summary-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .tab-btn {
            padding: 10px 20px;
            border: none;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            cursor: pointer;
            border-radius: 5px;
            font-size: 1em;
            transition: all 0.3s ease;
        }
        
        .tab-btn.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        .tab-btn:hover {
            background-color: var(--primary-color);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .card {
            background: var(--bg-primary);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border-color);
        }
        
        .card h3 {
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
        }
        
        .badge.high {
            background-color: #fee;
            color: #c33;
        }
        
        .badge.low {
            background-color: #efe;
            color: #3c3;
        }
        
        .card-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .card-row:last-child {
            border-bottom: none;
        }
        
        .card-label {
            color: var(--text-secondary);
            font-size: 0.9em;
        }
        
        .card-value {
            font-weight: bold;
        }
        
        .positive {
            color: #c33;
        }
        
        .negative {
            color: #3c3;
        }
        
        .gauge-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .gauge-card {
            background: var(--bg-primary);
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            border: 1px solid var(--border-color);
        }
        
        .gauge-value {
            font-size: 3em;
            font-weight: bold;
            margin: 20px 0;
        }
        
        .gauge-label {
            font-size: 1.3em;
            margin-bottom: 10px;
        }
        
        .gauge-description {
            color: var(--text-secondary);
            font-size: 0.9em;
        }
        
        .chart-container {
            background: var(--bg-primary);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            position: relative;
            height: 400px;
            border: 1px solid var(--border-color);
        }
        
        .flow-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-primary);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border-color);
        }
        
        .flow-table th {
            background-color: var(--primary-color);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }
        
        .flow-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .flow-table tr:hover {
            background-color: var(--bg-secondary);
        }
        
        .flow-table tr:last-child td {
            border-bottom: none;
        }
        
        .flow-indicator {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: bold;
        }
        
        .flow-inflow {
            background-color: #e8f5e9;
            color: #2e7d32;
        }
        
        .flow-outflow {
            background-color: #ffebee;
            color: #c62828;
        }
        
        .calculator-form {
            background: var(--bg-primary);
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 1em;
        }
        
        .form-group button {
            padding: 10px 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }
        
        .form-group button:hover {
            opacity: 0.8;
        }
        
        .result-box {
            background: var(--bg-secondary);
            padding: 20px;
            border-radius: 5px;
            margin-top: 20px;
            border-left: 4px solid var(--primary-color);
        }
        
        .export-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .export-btn {
            padding: 10px 20px;
            background-color: var(--success-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }
        
        .export-btn:hover {
            opacity: 0.8;
        }
        
        ul {
            margin-left: 20px;
            line-height: 1.8;
        }
        
        a {
            color: var(--primary-color);
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            border-top: 1px solid var(--border-color);
            color: var(--text-secondary);
            font-size: 0.9em;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab-btn {
                width: 100%;
            }
            
            .chart-container {
                height: 300px;
            }
            
            .top-bar {
                flex-direction: column;
                align-items: stretch;
            }
            
            .theme-toggle, .language-select {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="top-bar">
            <div>
                <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ™ æ·±è‰²æ¨¡å¼</button>
            </div>
            <div>
                <select class="language-select" onchange="changeLanguage(this.value)">
                    <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                    <option value="en">English</option>
                    <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                </select>
            </div>
            <div class="export-buttons">
                <button class="export-btn" onclick="exportPDF()">ğŸ“¥ ä¸‹è¼‰ PDF</button>
                <button class="export-btn" onclick="exportCSV()">ğŸ“Š ä¸‹è¼‰ CSV</button>
            </div>
        </div>
        
        <header>
            <h1 id="title">æ­·å²æœ¬ç›Šæ¯”åˆ†æå ±å‘Š</h1>
            <p class="subtitle" id="subtitle">Historical P/E Ratio Analysis Report</p>
            <div class="meta">
                <span id="author">ä½œè€…ï¼šAI é‡‘èåˆ†æå¸«</span> â€¢ 
                <span id="date">ç™¼å¸ƒæ—¥æœŸï¼š2025å¹´10æœˆ</span> â€¢ 
                <span id="source">æ•¸æ“šä¾†æºï¼šå¤šé‡æ¬Šå¨é‡‘èæ•¸æ“šæä¾›å•†</span>
            </div>
        </header>
        
        <div class="summary-card">
            <h2 id="summary-title">åŸ·è¡Œæ‘˜è¦</h2>
            <p id="summary-text">æœ¬å ±å‘Šåˆ†æäº†ä¸»è¦è‚¡ç¥¨å¸‚å ´æŒ‡æ•¸çš„æ­·å²æœ¬ç›Šæ¯”æ•¸æ“šï¼ŒåŒ…æ‹¬æ¨™æ™®500ã€é“ç“Šå·¥æ¥­å¹³å‡æŒ‡æ•¸å’Œç´æ–¯é”å…‹ç¶œåˆæŒ‡æ•¸ã€‚é€šéæ¯”è¼ƒç•¶å‰æœ¬ç›Šæ¯”èˆ‡æ­·å²å¹³å‡å€¼ï¼Œæˆ‘å€‘ç™¼ç¾ç•¶å‰å¸‚å ´æ•´é«”å‘ˆç¾è¼•å¾®é«˜ä¼°ç‹€æ…‹ï¼ŒæŠ•è³‡è€…æ‡‰ä¿æŒè¬¹æ…æ¨‚è§€çš„æ…‹åº¦ã€‚è³‡é‡‘æµå‘åˆ†æé¡¯ç¤ºæ©Ÿæ§‹æŠ•è³‡è€…å°ç§‘æŠ€è‚¡çš„èˆˆè¶£æŒçºŒé«˜æ¼²ï¼Œè€Œå°å‚³çµ±è£½é€ æ¥­çš„æŠ•è³‡æœ‰æ‰€æ¸›å°‘ã€‚</p>
        </div>
        
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab(event, 'overview')" id="tab-overview">ğŸ“Š ç¸½è¦½</button>
            <button class="tab-btn" onclick="switchTab(event, 'sentiment')" id="tab-sentiment">ğŸ“ˆ å¸‚å ´æƒ…ç·’</button>
            <button class="tab-btn" onclick="switchTab(event, 'fundflow')" id="tab-fundflow">ğŸ’° è³‡é‡‘æµå‘</button>
            <button class="tab-btn" onclick="switchTab(event, 'calculator')" id="tab-calculator">ğŸ§® è¨ˆç®—å™¨</button>
            <button class="tab-btn" onclick="switchTab(event, 'insights')" id="tab-insights">ğŸ’¡ æŠ•è³‡å•Ÿç¤º</button>
            <button class="tab-btn" onclick="switchTab(event, 'references')" id="tab-references">ğŸ“š åƒè€ƒè³‡æ–™</button>
        </div>
        
        <!-- Overview Tab -->
        <div id="overview" class="tab-content active">
            <div class="card-grid">
                <div class="card">
                    <h3>æ¨™æ™®500 <span class="badge high">é«˜ä¼°</span></h3>
                    <div class="card-row"><span class="card-label">æ­·å²å¹³å‡</span><span class="card-value">16.8</span></div>
                    <div class="card-row"><span class="card-label">ç•¶å‰æ°´å¹³</span><span class="card-value">28.5</span></div>
                    <div class="card-row"><span class="card-label">è®ŠåŒ–</span><span class="card-value positive">+69.6%</span></div>
                    <p style="color: var(--text-secondary); font-size: 0.9em; margin-top: 10px;">ç•¶å‰æœ¬ç›Šæ¯”é«˜æ–¼æ­·å²å¹³å‡æ°´å¹³ï¼Œå»ºè­°è¬¹æ…æŠ•è³‡ã€‚</p>
                </div>
                
                <div class="card">
                    <h3>é“ç“Šå·¥æ¥­ <span class="badge high">é«˜ä¼°</span></h3>
                    <div class="card-row"><span class="card-label">æ­·å²å¹³å‡</span><span class="card-value">15.2</span></div>
                    <div class="card-row"><span class="card-label">ç•¶å‰æ°´å¹³</span><span class="card-value">26.8</span></div>
                    <div class="card-row"><span class="card-label">è®ŠåŒ–</span><span class="card-value positive">+76.3%</span></div>
                    <p style="color: var(--text-secondary); font-size: 0.9em; margin-top: 10px;">æœ¬ç›Šæ¯”å¤§å¹…é«˜æ–¼æ­·å²å¹³å‡ï¼Œå­˜åœ¨é«˜ä¼°é¢¨éšªã€‚</p>
                </div>
                
                <div class="card">
                    <h3>ç´æ–¯é”å…‹ <span class="badge high">é«˜ä¼°</span></h3>
                    <div class="card-row"><span class="card-label">æ­·å²å¹³å‡</span><span class="card-value">22.4</span></div>
                    <div class="card-row"><span class="card-label">ç•¶å‰æ°´å¹³</span><span class="card-value">35.2</span></div>
                    <div class="card-row"><span class="card-label">è®ŠåŒ–</span><span class="card-value positive">+57.1%</span></div>
                    <p style="color: var(--text-secondary); font-size: 0.9em; margin-top: 10px;">ç§‘æŠ€è‚¡é›†ä¸­çš„ç´æ–¯é”å…‹é¡¯ç¤ºé«˜ä¼°å€¼ç‰¹å¾µã€‚</p>
                </div>
                
                <div class="card">
                    <h3>æ’ç”ŸæŒ‡æ•¸ <span class="badge low">ä½ä¼°</span></h3>
                    <div class="card-row"><span class="card-label">æ­·å²å¹³å‡</span><span class="card-value">12.8</span></div>
                    <div class="card-row"><span class="card-label">ç•¶å‰æ°´å¹³</span><span class="card-value">9.2</span></div>
                    <div class="card-row"><span class="card-label">è®ŠåŒ–</span><span class="card-value negative">-28.1%</span></div>
                    <p style="color: var(--text-secondary); font-size: 0.9em; margin-top: 10px;">é¦™æ¸¯å¸‚å ´ç›¸å°ç©©å®šï¼Œå¯èƒ½å­˜åœ¨æŠ•è³‡æ©Ÿæœƒã€‚</p>
                </div>
            </div>
            
            <div class="chart-container" style="margin-top: 30px;">
                <canvas id="peRatioChart"></canvas>
            </div>
        </div>
        
        <!-- Sentiment Tab -->
        <div id="sentiment" class="tab-content">
            <div class="gauge-container">
                <div class="gauge-card">
                    <h3>ç¾åœ‹å¸‚å ´ææ‡¼èˆ‡è²ªå©ªæŒ‡æ•¸</h3>
                    <div class="gauge-value" style="color: #f97316;">29</div>
                    <div class="gauge-label">ææ‡¼</div>
                    <div class="gauge-description">ç¾åœ‹å¸‚å ´ç•¶å‰è™•æ–¼ææ‡¼ç‹€æ…‹</div>
                </div>
                
                <div class="gauge-card">
                    <h3>é¦™æ¸¯å¸‚å ´ææ‡¼èˆ‡è²ªå©ªæŒ‡æ•¸</h3>
                    <div class="gauge-value" style="color: #22c55e;">67</div>
                    <div class="gauge-label">è²ªå©ª</div>
                    <div class="gauge-description">é¦™æ¸¯å¸‚å ´ç•¶å‰è™•æ–¼è²ªå©ªç‹€æ…‹</div>
                </div>
            </div>
            
            <div class="chart-container" style="margin-top: 30px;">
                <canvas id="sentimentChart"></canvas>
            </div>
            
            <div class="chart-container" style="margin-top: 30px;">
                <canvas id="sentimentGaugeChart"></canvas>
            </div>
        </div>
        
        <!-- Fund Flow Tab -->
        <div id="fundflow" class="tab-content">
            <div class="card" style="margin-bottom: 30px;">
                <h3>è³‡é‡‘æµå‘åˆ†ææ¦‚è¿°</h3>
                <p>ç•¶å‰å¸‚å ´è³‡é‡‘æµå‘å‘ˆç¾æ˜é¡¯çš„çµæ§‹æ€§ç‰¹å¾µã€‚æ©Ÿæ§‹æŠ•è³‡è€…æŒçºŒåŠ ç¢¼ç§‘æŠ€è‚¡å’Œæ–°èˆˆç”¢æ¥­ï¼Œè€Œå‚³çµ±è£½é€ æ¥­å’Œé‡‘èè‚¡é¢è‡¨è³‡é‡‘å¤–æµã€‚ä»¥ä¸‹æ˜¯è©³ç´°çš„è³‡é‡‘æµå‘æ•¸æ“šï¼š</p>
            </div>
            
            <div class="chart-container" style="margin-bottom: 30px;">
                <canvas id="fundFlowChart"></canvas>
            </div>
            
            <div class="card" style="margin-bottom: 30px;">
                <h3>ä¸»è¦è¡Œæ¥­è³‡é‡‘æµå‘</h3>
                <table class="flow-table">
                    <thead>
                        <tr>
                            <th>è¡Œæ¥­éƒ¨é–€</th>
                            <th>æœ¬é€±è³‡é‡‘æµå‘</th>
                            <th>æœˆåº¦ç´¯è¨ˆ</th>
                            <th>å¹´åº¦ç´¯è¨ˆ</th>
                            <th>è¶¨å‹¢</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ç§‘æŠ€è‚¡</td>
                            <td><span class="flow-indicator flow-inflow">æ·¨æµå…¥ $2.5B</span></td>
                            <td>$12.3B</td>
                            <td>$45.8B</td>
                            <td style="color: #2e7d32; font-weight: bold;">â†‘ å¼·å‹</td>
                        </tr>
                        <tr>
                            <td>æ¶ˆè²»è€…éå¿…éœ€å“</td>
                            <td><span class="flow-indicator flow-inflow">æ·¨æµå…¥ $1.2B</span></td>
                            <td>$5.6B</td>
                            <td>$18.2B</td>
                            <td style="color: #2e7d32; font-weight: bold;">â†‘ ç©©å®š</td>
                        </tr>
                        <tr>
                            <td>é‡‘èæœå‹™</td>
                            <td><span class="flow-indicator flow-outflow">æ·¨æµå‡º $0.8B</span></td>
                            <td>-$2.1B</td>
                            <td>-$5.3B</td>
                            <td style="color: #c62828; font-weight: bold;">â†“ å¼±å‹¢</td>
                        </tr>
                        <tr>
                            <td>è£½é€ æ¥­</td>
                            <td><span class="flow-indicator flow-outflow">ï¿½æ·¨æµå‡º $1.5B</span></td>
                            <td>-$4.2B</td>
                            <td>-$12.8B</td>
                            <td style="color: #c62828; font-weight: bold;">â†“ ä¸‹æ»‘</td>
                        </tr>
                        <tr>
                            <td>é†«ç™‚ä¿å¥</td>
                            <td><span class="flow-indicator flow-inflow">æ·¨æµå…¥ $0.9B</span></td>
                            <td>$3.4B</td>
                            <td>$11.7B</td>
                            <td style="color: #2e7d32; font-weight: bold;">â†‘ ç©©å®š</td>
                        </tr>
                        <tr>
                            <td>èƒ½æº</td>
                            <td><span class="flow-indicator flow-outflow">æ·¨æµå‡º $0.6B</span></td>
                            <td>-$1.8B</td>
                            <td>-$3.2B</td>
                            <td style="color: #c62828; font-weight: bold;">â†“ æ³¢å‹•</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="card">
                <h3>æ©Ÿæ§‹æŠ•è³‡è€…å‹•å‘</h3>
                <ul>
                    <li><strong>å°æ²–åŸºé‡‘ï¼š</strong> å¢åŠ ç§‘æŠ€è‚¡å’Œæ–°èˆˆå¸‚å ´çš„æ•å£ï¼Œæ¸›å°‘å‚³çµ±è£½é€ æ¥­æŒå€‰</li>
                    <li><strong>é¤Šè€åŸºé‡‘ï¼š</strong> ç¹¼çºŒè²·å…¥é˜²ç¦¦æ€§è‚¡ç¥¨å’Œå…¬ç”¨äº‹æ¥­è‚¡ï¼Œå°‹æ±‚ç©©å®šæ”¶ç›Š</li>
                    <li><strong>å…±åŒåŸºé‡‘ï¼š</strong> å¢åŠ ESGç›¸é—œæŠ•è³‡ï¼Œé—œæ³¨å¯æŒçºŒç™¼å±•æ¦‚å¿µ</li>
                    <li><strong>å¤–è³‡æ©Ÿæ§‹ï¼š</strong> å°é¦™æ¸¯å’Œæ–°èˆˆå¸‚å ´è¡¨ç¾å‡ºèˆˆè¶£ï¼Œå°‹æ±‚ä¼°å€¼æ´¼åœ°</li>
                    <li><strong>æ•£æˆ¶æŠ•è³‡è€…ï¼š</strong> è·Ÿé¢¨ç§‘æŠ€è‚¡ï¼Œä½†é¢¨éšªæ‰¿å—èƒ½åŠ›æœ‰é™</li>
                </ul>
            </div>
        </div>
        
        <!-- Calculator Tab -->
        <div id="calculator" class="tab-content">
            <div class="calculator-form">
                <h2>P/E æ¯”ç‡è¨ˆç®—å™¨</h2>
                <p style="margin-bottom: 20px; color: var(--text-secondary);">è¼¸å…¥è‚¡ç¥¨ä¿¡æ¯ï¼Œè‡ªå‹•è¨ˆç®—æœ¬ç›Šæ¯”ä¸¦èˆ‡æ­·å²å¹³å‡å€¼æ¯”è¼ƒ</p>
                
                <div class="form-group">
                    <label for="stockName">å…¬å¸åç¨±</label>
                    <input type="text" id="stockName" placeholder="ä¾‹å¦‚ï¼šApple Inc.">
                </div>
                
                <div class="form-group">
                    <label for="stockPrice">ç•¶å‰è‚¡åƒ¹ ($)</label>
                    <input type="number" id="stockPrice" placeholder="ä¾‹å¦‚ï¼š150.25" step="0.01">
                </div>
                
                <div class="form-group">
                    <label for="eps">æ¯è‚¡æ”¶ç›Š (EPS) ($)</label>
                    <input type="number" id="eps" placeholder="ä¾‹å¦‚ï¼š5.61" step="0.01">
                </div>
                
                <div class="form-group">
                    <label for="historicalAvg">æ­·å²å¹³å‡ P/E æ¯”ç‡</label>
                    <input type="number" id="historicalAvg" placeholder="ä¾‹å¦‚ï¼š25" step="0.1">
                </div>
                
                <div class="form-group">
                    <button onclick="calculatePE()">è¨ˆç®— P/E æ¯”ç‡</button>
                </div>
                
                <div id="calculatorResult"></div>
            </div>
        </div>
        
        <!-- Insights Tab -->
        <div id="insights" class="tab-content">
            <div class="card">
                <h3>æŠ•è³‡å•Ÿç¤º</h3>
                <p>åŸºæ–¼ç•¶å‰æœ¬ç›Šæ¯”åˆ†æå’Œè³‡é‡‘æµå‘ï¼Œæˆ‘å€‘æä¾›ä»¥ä¸‹æŠ•è³‡å»ºè­°ï¼š</p>
                <ul style="margin-top: 15px;">
                    <li><strong>ç§‘æŠ€è‚¡ï¼š</strong> é›–ç„¶ä¼°å€¼è¼ƒé«˜ï¼Œä½†è³‡é‡‘æŒçºŒæµå…¥ï¼ŒçŸ­æœŸå¯èƒ½ç¹¼çºŒä¸Šæ¼²ã€‚å»ºè­°è¨­ç½®æ­¢æé»ï¼Œæ§åˆ¶é¢¨éšªã€‚</li>
                    <li><strong>å‚³çµ±è£½é€ æ¥­ï¼š</strong> é¢è‡¨è³‡é‡‘å¤–æµï¼Œä¼°å€¼ç›¸å°åˆç†ã€‚é•·æœŸæŠ•è³‡è€…å¯è€ƒæ…®é€¢ä½å¸ƒå±€ã€‚</li>
                    <li><strong>é¦™æ¸¯å¸‚å ´ï¼š</strong> æ’ç”ŸæŒ‡æ•¸ç›¸å°ä½ä¼°ï¼Œæ©Ÿæ§‹æŠ•è³‡è€…é–‹å§‹é—œæ³¨ã€‚å¯ä½œç‚ºåˆ†æ•£æŠ•è³‡çš„é¸æ“‡ã€‚</li>
                    <li><strong>é†«ç™‚ä¿å¥ï¼š</strong> è³‡é‡‘æµå‘ç©©å®šï¼Œé˜²ç¦¦æ€§å¼·ï¼Œé©åˆé¢¨éšªå­æƒ¡å‹æŠ•è³‡è€…ã€‚</li>
                    <li><strong>è³‡ç”¢é…ç½®ï¼š</strong> å»ºè­°60%ç§‘æŠ€è‚¡ã€25%é˜²ç¦¦æ€§è‚¡ç¥¨ã€15%æ–°èˆˆå¸‚å ´ã€‚</li>
                    <li><strong>é¢¨éšªç®¡ç†ï¼š</strong> ç•¶å‰å¸‚å ´æ³¢å‹•æ€§è¼ƒé«˜ï¼Œå»ºè­°ä½¿ç”¨æ­¢æå–®å’Œåˆ†æ‰¹å»ºå€‰ç­–ç•¥ã€‚</li>
                </ul>
            </div>
        </div>
        
        <!-- References Tab -->
        <div id="references" class="tab-content">
            <div class="card">
                <h3>åƒè€ƒè³‡æ–™</h3>
                <ul>
                    <li><a href="https://www.investopedia.com/terms/p/price-earningsratio.asp" target="_blank">æœ¬ç›Šæ¯”å®šç¾©èˆ‡åˆ†æ - Investopedia</a></li>
                    <li><a href="https://www.cnbc.com/quotes/.INDU" target="_blank">é“ç“Šå·¥æ¥­å¹³å‡æŒ‡æ•¸ - CNBC</a></li>
                    <li><a href="https://www.cnbc.com/quotes/.GSPC" target="_blank">æ¨™æ™®500æŒ‡æ•¸ - CNBC</a></li>
                    <li><a href="https://www.cnbc.com/quotes/.IXIC" target="_blank">ç´æ–¯é”å…‹ç¶œåˆæŒ‡æ•¸ - CNBC</a></li>
                    <li><a href="https://www.bloomberg.com" target="_blank">å½­åšè³‡è¨Š - Bloomberg</a></li>
                    <li><a href="https://www.reuters.com" target="_blank">è·¯é€ç¤¾ - Reuters</a></li>
                </ul>
            </div>
        </div>
        
        <div class="footer">
            <p>Â© 2025 æ­·å²æœ¬ç›Šæ¯”åˆ†æå ±å‘Šã€‚æ‰€æœ‰æ•¸æ“šåƒ…ä¾›åƒè€ƒï¼Œä¸æ§‹æˆæŠ•è³‡å»ºè­°ã€‚æŠ•è³‡å‰è«‹è«®è©¢å°ˆæ¥­è²¡å‹™é¡§å•ã€‚</p>
        </div>
    </div>
    
    <script>
        // èªè¨€é…ç½®
        const translations = {
            'zh-TW': {
                title: 'æ­·å²æœ¬ç›Šæ¯”åˆ†æå ±å‘Š',
                subtitle: 'Historical P/E Ratio Analysis Report',
                author: 'ä½œè€…ï¼šAI é‡‘èåˆ†æå¸«',
                date: 'ç™¼å¸ƒæ—¥æœŸï¼š2025å¹´10æœˆ',
                source: 'æ•¸æ“šä¾†æºï¼šå¤šé‡æ¬Šå¨é‡‘èæ•¸æ“šæä¾›å•†',
                'summary-title': 'åŸ·è¡Œæ‘˜è¦',
                'tab-overview': 'ğŸ“Š ç¸½è¦½',
                'tab-sentiment': 'ğŸ“ˆ å¸‚å ´æƒ…ç·’',
                'tab-fundflow': 'ğŸ’° è³‡é‡‘æµå‘',
                'tab-calculator': 'ğŸ§® è¨ˆç®—å™¨',
                'tab-insights': 'ğŸ’¡ æŠ•è³‡å•Ÿç¤º',
                'tab-references': 'ğŸ“š åƒè€ƒè³‡æ–™'
            },
            'en': {
                title: 'Historical P/E Ratio Analysis Report',
                subtitle: 'Investment Analysis and Market Insights',
                author: 'Author: AI Financial Analyst',
                date: 'Published: October 2025',
                source: 'Data Source: Multiple Authoritative Financial Data Providers',
                'summary-title': 'Executive Summary',
                'tab-overview': 'ğŸ“Š Overview',
                'tab-sentiment': 'ğŸ“ˆ Market Sentiment',
                'tab-fundflow': 'ğŸ’° Fund Flow',
                'tab-calculator': 'ğŸ§® Calculator',
                'tab-insights': 'ğŸ’¡ Investment Insights',
                'tab-references': 'ğŸ“š References'
            },
            'zh-CN': {
                title: 'å†å²æœ¬ç›Šæ¯”åˆ†ææŠ¥å‘Š',
                subtitle: 'Historical P/E Ratio Analysis Report',
                author: 'ä½œè€…ï¼šAI é‡‘èåˆ†æå¸ˆ',
                date: 'å‘å¸ƒæ—¥æœŸï¼š2025å¹´10æœˆ',
                source: 'æ•°æ®æ¥æºï¼šå¤šé‡æƒå¨é‡‘èæ•°æ®æä¾›å•†',
                'summary-title': 'æ‰§è¡Œæ‘˜è¦',
                'tab-overview': 'ğŸ“Š æ€»è§ˆ',
                'tab-sentiment': 'ğŸ“ˆ å¸‚åœºæƒ…ç»ª',
                'tab-fundflow': 'ğŸ’° èµ„é‡‘æµå‘',
                'tab-calculator': 'ğŸ§® è®¡ç®—å™¨',
                'tab-insights': 'ğŸ’¡ æŠ•èµ„å¯ç¤º',
                'tab-references': 'ğŸ“š å‚è€ƒèµ„æ–™'
            }
        };
        
        let currentLanguage = 'zh-TW';
        let isDarkMode = localStorage.getItem('darkMode') === 'true';
        
        // åˆå§‹åŒ–ä¸»é¡Œ
        if (isDarkMode) {
            document.body.classList.add('dark-mode');
            document.querySelector('.theme-toggle').textContent = 'â˜€ï¸ æ·ºè‰²æ¨¡å¼';
        }
        
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('darkMode', isDarkMode);
            document.querySelector('.theme-toggle').textContent = isDarkMode ? 'â˜€ï¸ æ·ºè‰²æ¨¡å¼' : 'ğŸŒ™ æ·±è‰²æ¨¡å¼';
        }
        
        function changeLanguage(lang) {
            currentLanguage = lang;
            updateLanguage();
        }
        
        function updateLanguage() {
            const trans = translations[currentLanguage];
            document.getElementById('title').textContent = trans.title;
            document.getElementById('subtitle').textContent = trans.subtitle;
            document.getElementById('author').textContent = trans.author;
            document.getElementById('date').textContent = trans.date;
            document.getElementById('source').textContent = trans.source;
            document.getElementById('summary-title').textContent = trans['summary-title'];
            document.getElementById('tab-overview').textContent = trans['tab-overview'];
            document.getElementById('tab-sentiment').textContent = trans['tab-sentiment'];
            document.getElementById('tab-fundflow').textContent = trans['tab-fundflow'];
            document.getElementById('tab-calculator').textContent = trans['tab-calculator'];
            document.getElementById('tab-insights').textContent = trans['tab-insights'];
            document.getElementById('tab-references').textContent = trans['tab-references'];
        }
        
        function switchTab(event, tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            const buttons = document.querySelectorAll('.tab-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            setTimeout(() => {
                if (tabName === 'sentiment') {
                    sentimentChart.resize();
                    sentimentGaugeChart.resize();
                } else if (tabName === 'fundflow') {
                    fundFlowChart.resize();
                } else if (tabName === 'overview') {
                    peRatioChart.resize();
                }
            }, 100);
        }
        
        function calculatePE() {
            const stockName = document.getElementById('stockName').value;
            const stockPrice = parseFloat(document.getElementById('stockPrice').value);
            const eps = parseFloat(document.getElementById('eps').value);
            const historicalAvg = parseFloat(document.getElementById('historicalAvg').value);
            
            if (!stockName || !stockPrice || !eps || !historicalAvg) {
                alert('è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½');
                return;
            }
            
            const currentPE = (stockPrice / eps).toFixed(2);
            const difference = ((currentPE - historicalAvg) / historicalAvg * 100).toFixed(2);
            const status = currentPE > historicalAvg ? 'é«˜ä¼°' : currentPE < historicalAvg ? 'ä½ä¼°' : 'åˆç†';
            const statusColor = currentPE > historicalAvg ? '#c33' : currentPE < historicalAvg ? '#3c3' : '#f97316';
            
            const resultHTML = `
                <div class="result-box">
                    <h3>${stockName} - P/E æ¯”ç‡åˆ†æ</h3>
                    <div class="card-row" style="margin-top: 15px;">
                        <span class="card-label">ç•¶å‰ P/E æ¯”ç‡</span>
                        <span class="card-value">${currentPE}</span>
                    </div>
                    <div class="card-row">
                        <span class="card-label">æ­·å²å¹³å‡ P/E</span>
                        <span class="card-value">${historicalAvg}</span>
                    </div>
                    <div class="card-row">
                        <span class="card-label">å·®ç•°</span>
                        <span class="card-value" style="color: ${statusColor};">${difference > 0 ? '+' : ''}${difference}%</span>
                    </div>
                    <div class="card-row">
                        <span class="card-label">ä¼°å€¼ç‹€æ…‹</span>
                        <span class="badge" style="background-color: ${statusColor}20; color: ${statusColor}; font-weight: bold;">${status}</span>
                    </div>
                    <p style="margin-top: 15px; color: var(--text-secondary);">
                        ${currentPE > historicalAvg ? `${stockName} çš„ç•¶å‰ä¼°å€¼é«˜æ–¼æ­·å²å¹³å‡æ°´å¹³ ${difference}%ï¼Œå»ºè­°è¬¹æ…æŠ•è³‡ã€‚` : `${stockName} çš„ç•¶å‰ä¼°å€¼ä½æ–¼æ­·å²å¹³å‡æ°´å¹³ ${Math.abs(difference)}%ï¼Œå¯èƒ½å­˜åœ¨æŠ•è³‡æ©Ÿæœƒã€‚`}
                    </p>
                </div>
            `;
            
            document.getElementById('calculatorResult').innerHTML = resultHTML;
        }
        
        function exportPDF() {
            const element = document.querySelector('.container');
            const opt = {
                margin: 10,
                filename: 'PE-Ratio-Analysis.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { orientation: 'portrait', unit: 'mm', format: 'a4' }
            };
            html2pdf().set(opt).from(element).save();
        }
        
        function exportCSV() {
            const data = [
                ['æŒ‡æ•¸', 'æ­·å²å¹³å‡', 'ç•¶å‰æ°´å¹³', 'è®ŠåŒ–', 'ç‹€æ…‹'],
                ['æ¨™æ™®500', '16.8', '28.5', '+69.6%', 'é«˜ä¼°'],
                ['é“ç“Šå·¥æ¥­', '15.2', '26.8', '+76.3%', 'é«˜ä¼°'],
                ['ç´æ–¯é”å…‹', '22.4', '35.2', '+57.1%', 'é«˜ä¼°'],
                ['æ’ç”ŸæŒ‡æ•¸', '12.8', '9.2', '-28.1%', 'ä½ä¼°']
            ];
            
            let csv = data.map(row => row.join(',')).join('\n');
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'PE-Ratio-Data.csv';
            a.click();
        }
        
        // P/E æ¯”ç‡å°æ¯”åœ–è¡¨
        const peRatioCtx = document.getElementById('peRatioChart');
        const peRatioChart = new Chart(peRatioCtx, {
            type: 'bar',
            data: {
                labels: ['æ¨™æ™®500', 'é“ç“Šå·¥æ¥­', 'ç´æ–¯é”å…‹', 'æ’ç”ŸæŒ‡æ•¸'],
                datasets: [
                    {
                        label: 'æ­·å²å¹³å‡',
                        data: [16.8, 15.2, 22.4, 12.8],
                        backgroundColor: '#667eea'
                    },
                    {
                        label: 'ç•¶å‰æ°´å¹³',
                        data: [28.5, 26.8, 35.2, 9.2],
                        backgroundColor: '#764ba2'
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'top' },
                    title: { display: true, text: 'P/E æ¯”ç‡å°æ¯”' }
                }
            }
        });
        
        // å¸‚å ´æƒ…ç·’è¶¨å‹¢åœ–è¡¨
        const sentimentCtx = document.getElementById('sentimentChart');
        const sentimentChart = new Chart(sentimentCtx, {
            type: 'line',
            data: {
                labels: ['9æœˆ1æ—¥', '9æœˆ8æ—¥', '9æœˆ15æ—¥', '9æœˆ22æ—¥', '9æœˆ29æ—¥', '10æœˆ6æ—¥', '10æœˆ13æ—¥', '10æœˆ20æ—¥', '10æœˆ27æ—¥'],
                datasets: [
                    {
                        label: 'ç¾åœ‹å¸‚å ´ææ‡¼èˆ‡è²ªå©ªæŒ‡æ•¸',
                        data: [42, 38, 35, 32, 28, 26, 29, 31, 29],
                        borderColor: '#f97316',
                        backgroundColor: 'rgba(249, 115, 22, 0.1)',
                        tension: 0.4,
                        fill: true
                    },
                    {
                        label: 'é¦™æ¸¯å¸‚å ´ææ‡¼èˆ‡è²ªå©ªæŒ‡æ•¸',
                        data: [55, 58, 62, 64, 66, 68, 67, 66, 67],
                        borderColor: '#22c55e',
                        backgroundColor: 'rgba(34, 197, 94, 0.1)',
                        tension: 0.4,
                        fill: true
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'top' },
                    title: { display: true, text: 'å¸‚å ´æƒ…ç·’è¶¨å‹¢' }
                },
                scales: { y: { min: 0, max: 100 } }
            }
        });
        
        // å¸‚å ´æƒ…ç·’è¦è¡¨åœ–è¡¨
        const sentimentGaugeCtx = document.getElementById('sentimentGaugeChart');
        const sentimentGaugeChart = new Chart(sentimentGaugeCtx, {
            type: 'doughnut',
            data: {
                labels: ['ç¾åœ‹å¸‚å ´ (ææ‡¼)', 'é¦™æ¸¯å¸‚å ´ (è²ªå©ª)'],
                datasets: [{
                    data: [29, 67],
                    backgroundColor: ['#f97316', '#22c55e'],
                    borderColor: ['#f97316', '#22c55e']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'bottom' },
                    title: { display: true, text: 'ç•¶å‰å¸‚å ´æƒ…ç·’åˆ†ä½ˆ' }
                }
            }
        });
        
        // è³‡é‡‘æµå‘åœ–è¡¨
        const fundFlowCtx = document.getElementById('fundFlowChart');
        const fundFlowChart = new Chart(fundFlowCtx, {
            type: 'bar',
            data: {
                labels: ['ç§‘æŠ€è‚¡', 'æ¶ˆè²»è€…\néå¿…éœ€å“', 'é‡‘èæœå‹™', 'è£½é€ æ¥­', 'é†«ç™‚ä¿å¥', 'èƒ½æº'],
                datasets: [{
                    label: 'æœ¬é€±è³‡é‡‘æµå‘ (åå„„ç¾å…ƒ)',
                    data: [2.5, 1.2, -0.8, -1.5, 0.9, -0.6],
                    backgroundColor: [
                        '#22c55e', '#22c55e', '#ef4444', '#ef4444', '#22c55e', '#ef4444'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: true },
                    title: { display: true, text: 'å„è¡Œæ¥­æœ¬é€±è³‡é‡‘æµå‘' }
                },
                scales: {
                    y: {
                        ticks: {
                            callback: function(value) {
                                return value + 'B';
                            }
                        }
                    }
                }
            }
        });
        
        // åˆå§‹åŒ–èªè¨€
        updateLanguage();
    </script>
</body>
</html>
