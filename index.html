<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ˆæ¥­æœ¬ç›Šæ¯”åˆ†æå¹³å° | Professional P/E Analysis Platform</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --success-color: #22c55e;
            --danger-color: #ef4444;
            --warning-color: #f97316;
            --bg-primary: #ffffff;
            --bg-secondary: #f5f7fa;
            --text-primary: #333333;
            --text-secondary: #666666;
            --border-color: #e0e0e0;
        }
        
        body.dark-mode {
            --bg-primary: #1e1e1e;
            --bg-secondary: #2d2d2d;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --border-color: #444444;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--text-primary);
            transition: background 0.3s ease;
        }
        
        body.dark-mode {
            background: linear-gradient(135deg, #1e1e1e 0%, #2d2d2d 100%);
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            background-color: var(--primary-color);
            color: white;
            cursor: pointer;
            border-radius: 5px;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            opacity: 0.8;
        }
        
        .language-select {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            background-color: var(--bg-primary);
            color: var(--text-primary);
            cursor: pointer;
            border-radius: 5px;
            font-size: 0.9em;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            font-size: 1.2em;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }
        
        .meta {
            font-size: 0.9em;
            color: var(--text-secondary);
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .tab-btn {
            padding: 10px 20px;
            border: none;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            cursor: pointer;
            border-radius: 5px;
            font-size: 1em;
            transition: all 0.3s ease;
        }
        
        .tab-btn.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        .tab-btn:hover {
            background-color: var(--primary-color);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .card {
            background: var(--bg-primary);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border-color);
            margin-bottom: 20px;
        }
        
        .card h3 {
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .chart-container {
            background: var(--bg-primary);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            position: relative;
            height: 400px;
            border: 1px solid var(--border-color);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 1em;
        }
        
        .form-group button {
            padding: 10px 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }
        
        .form-group button:hover {
            opacity: 0.8;
        }
        
        .result-box {
            background: var(--bg-secondary);
            padding: 20px;
            border-radius: 5px;
            border-left: 4px solid var(--primary-color);
            margin-top: 20px;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-primary);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border-color);
            margin-bottom: 20px;
        }
        
        .table th {
            background-color: var(--primary-color);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }
        
        .table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .table tr:hover {
            background-color: var(--bg-secondary);
        }
        
        .table tr:last-child td {
            border-bottom: none;
        }
        
        .badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
        }
        
        .badge-success {
            background-color: #e8f5e9;
            color: #2e7d32;
        }
        
        .badge-danger {
            background-color: #ffebee;
            color: #c62828;
        }
        
        .badge-warning {
            background-color: #fff3e0;
            color: #e65100;
        }
        
        .badge-info {
            background-color: #e3f2fd;
            color: #1565c0;
        }
        
        .portfolio-item {
            background: var(--bg-secondary);
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid var(--primary-color);
        }
        
        .portfolio-item-remove {
            background-color: #ef4444;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8em;
        }
        
        .filter-section {
            background: var(--bg-secondary);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }
        
        .filter-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .filter-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .filter-group input, .filter-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }
        
        .ai-recommendation {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .ai-score {
            font-size: 2em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .dashboard-widget {
            background: var(--bg-primary);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border-color);
            cursor: move;
            position: relative;
        }
        
        .dashboard-widget-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .dashboard-widget-title {
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .dashboard-widget-remove {
            background-color: #ef4444;
            color: white;
            border: none;
            padding: 3px 8px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8em;
        }
        
        .alert-item {
            background: var(--bg-secondary);
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 10px;
            border-left: 4px solid var(--warning-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .alert-item-remove {
            background-color: #ef4444;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8em;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
        }
        
        .modal-content {
            background-color: var(--bg-primary);
            margin: 10% auto;
            padding: 30px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-close {
            color: var(--text-secondary);
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .modal-close:hover {
            color: var(--text-primary);
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            border-top: 1px solid var(--border-color);
            color: var(--text-secondary);
            font-size: 0.9em;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab-btn {
                width: 100%;
            }
            
            .chart-container {
                height: 300px;
            }
            
            .top-bar {
                flex-direction: column;
                align-items: stretch;
            }
            
            .btn, .language-select {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="top-bar">
            <div>
                <button class="btn" onclick="toggleTheme()">ğŸŒ™ æ·±è‰²æ¨¡å¼</button>
            </div>
            <div>
                <select class="language-select" onchange="changeLanguage(this.value)">
                    <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                    <option value="en">English</option>
                    <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                </select>
            </div>
            <div>
                <button class="btn" onclick="exportPDF()">ğŸ“¥ ä¸‹è¼‰ PDF</button>
                <button class="btn" onclick="exportCSV()">ğŸ“Š ä¸‹è¼‰ CSV</button>
            </div>
        </div>
        
        <header>
            <h1 id="title">å°ˆæ¥­æœ¬ç›Šæ¯”åˆ†æå¹³å°</h1>
            <p class="subtitle" id="subtitle">Professional P/E Ratio Analysis Platform</p>
            <div class="meta">
                <span id="author">ä½œè€…ï¼šAI é‡‘èåˆ†æå¸«</span> â€¢ 
                <span id="date">ç™¼å¸ƒæ—¥æœŸï¼š2025å¹´11æœˆ6æ—¥</span> â€¢ 
                <span id="source">æ•¸æ“šä¾†æºï¼šå¤šé‡æ¬Šå¨é‡‘èæ•¸æ“šæä¾›å•†</span>
            </div>
        </header>
        
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab(event, 'dashboard')" id="tab-dashboard">ğŸ“Š å„€è¡¨æ¿</button>
            <button class="tab-btn" onclick="switchTab(event, 'portfolio')" id="tab-portfolio">ğŸ’¼ æŠ•è³‡çµ„åˆ</button>
            <button class="tab-btn" onclick="switchTab(event, 'trends')" id="tab-trends">ğŸ“ˆ è¶¨å‹¢åˆ†æ</button>
            <button class="tab-btn" onclick="switchTab(event, 'alerts')" id="tab-alerts">ğŸ”” åƒ¹æ ¼è­¦å ±</button>
            <button class="tab-btn" onclick="switchTab(event, 'filter')" id="tab-filter">ğŸ” ç¯©é¸å·¥å…·</button>
            <button class="tab-btn" onclick="switchTab(event, 'compare')" id="tab-compare">âš–ï¸ å°æ¯”åˆ†æ</button>
            <button class="tab-btn" onclick="switchTab(event, 'ai')" id="tab-ai">ğŸ¤– AI å»ºè­°</button>
            <button class="tab-btn" onclick="switchTab(event, 'advanced')" id="tab-advanced">â­ é€²éšåŠŸèƒ½</button>
        </div>
        
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="card">
                <h3>ğŸ“Š è‡ªè¨‚å„€è¡¨æ¿</h3>
                <p style="color: var(--text-secondary); margin-bottom: 15px;">é¸æ“‡æ‚¨æƒ³è¦é¡¯ç¤ºçš„å°éƒ¨ä»¶ï¼Œæ‹–æ‹½æ’åºã€‚æ‚¨çš„é…ç½®æœƒè‡ªå‹•ä¿å­˜ã€‚</p>
                <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                    <button class="btn" onclick="addWidget('pe-overview')">+ P/E ç¸½è¦½</button>
                    <button class="btn" onclick="addWidget('sentiment-us')">+ ç¾åœ‹æƒ…ç·’</button>
                    <button class="btn" onclick="addWidget('sentiment-hk')">+ é¦™æ¸¯æƒ…ç·’</button>
                    <button class="btn" onclick="addWidget('hot-sectors-us')">+ ç¾è‚¡ç†±é»</button>
                    <button class="btn" onclick="addWidget('hot-sectors-hk')">+ æ¸¯è‚¡ç†±é»</button>
                    <button class="btn" onclick="addWidget('portfolio-summary')">+ çµ„åˆæ‘˜è¦</button>
                </div>
                <div id="dashboardWidgets" class="dashboard-grid">
                    <!-- å‹•æ…‹æ·»åŠ çš„å°éƒ¨ä»¶ -->
                </div>
            </div>
            
            <div class="card">
                <h3>ğŸ“ˆ å¸‚å ´æ¦‚è¦½</h3>
                <div class="card-grid">
                    <div class="card">
                        <h4>æ¨™æ™® 500</h4>
                        <div style="font-size: 1.5em; font-weight: bold; color: #667eea; margin: 10px 0;">28.5</div>
                        <div style="font-size: 0.9em; color: var(--text-secondary);">P/E æ¯”ç‡</div>
                        <div style="margin-top: 10px;">
                            <span class="badge badge-danger">é«˜ä¼° +69.6%</span>
                        </div>
                    </div>
                    <div class="card">
                        <h4>ç´æ–¯é”å…‹</h4>
                        <div style="font-size: 1.5em; font-weight: bold; color: #764ba2; margin: 10px 0;">35.2</div>
                        <div style="font-size: 0.9em; color: var(--text-secondary);">P/E æ¯”ç‡</div>
                        <div style="margin-top: 10px;">
                            <span class="badge badge-danger">é«˜ä¼° +57.1%</span>
                        </div>
                    </div>
                    <div class="card">
                        <h4>æ’ç”ŸæŒ‡æ•¸</h4>
                        <div style="font-size: 1.5em; font-weight: bold; color: #22c55e; margin: 10px 0;">9.2</div>
                        <div style="font-size: 0.9em; color: var(--text-secondary);">P/E æ¯”ç‡</div>
                        <div style="margin-top: 10px;">
                            <span class="badge badge-success">ä½ä¼° -28.1%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Portfolio Tab -->
        <div id="portfolio" class="tab-content">
            <div class="card">
                <h3>ğŸ’¼ æˆ‘çš„æŠ•è³‡çµ„åˆ</h3>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">æ·»åŠ æ‚¨æŒæœ‰çš„è‚¡ç¥¨ï¼Œè‡ªå‹•è¨ˆç®—çµ„åˆæŒ‡æ¨™å’Œé¢¨éšªè©•åˆ†ã€‚</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <div class="form-group">
                        <label>è‚¡ç¥¨ä»£ç¢¼</label>
                        <input type="text" id="portfolioSymbol" placeholder="ä¾‹å¦‚ï¼šAAPL">
                    </div>
                    <div class="form-group">
                        <label>æŒæœ‰æ•¸é‡</label>
                        <input type="number" id="portfolioShares" placeholder="ä¾‹å¦‚ï¼š100" min="1">
                    </div>
                    <div class="form-group">
                        <label>è²·å…¥åƒ¹æ ¼ ($)</label>
                        <input type="number" id="portfolioCost" placeholder="ä¾‹å¦‚ï¼š150.25" step="0.01" min="0">
                    </div>
                    <div class="form-group">
                        <label>ç•¶å‰åƒ¹æ ¼ ($)</label>
                        <input type="number" id="portfolioPrice" placeholder="ä¾‹å¦‚ï¼š165.50" step="0.01" min="0">
                    </div>
                </div>
                
                <button class="btn" onclick="addPortfolioItem()" style="width: 100%; margin-bottom: 20px;">+ æ·»åŠ åˆ°çµ„åˆ</button>
                
                <div id="portfolioItems" style="margin-bottom: 20px;">
                    <!-- å‹•æ…‹æ·»åŠ çš„é …ç›® -->
                </div>
            </div>
            
            <div class="card">
                <h3>çµ„åˆåˆ†æ</h3>
                <div id="portfolioAnalysis" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <!-- å‹•æ…‹ç”Ÿæˆçš„åˆ†æ -->
                </div>
            </div>
        </div>
        
        <!-- Trends Tab -->
        <div id="trends" class="tab-content">
            <div class="card">
                <h3>ğŸ“ˆ P/E æ¯”ç‡æ­·å²è¶¨å‹¢ï¼ˆå¤šæŒ‡æ•¸ï¼‰</h3>
                <p style="color: var(--text-secondary); margin-bottom: 15px;">æŸ¥çœ‹éå» 5 å¹´çš„ P/E æ¯”ç‡è®ŠåŒ–ï¼Œæ¨™è¨˜é‡è¦çš„å¸‚å ´äº‹ä»¶ã€‚</p>
                
                <div style="margin-bottom: 20px;">
                    <label style="margin-right: 15px;">
                        <input type="radio" name="trendRange" value="1m" onchange="updateTrendChart()"> 1 æœˆ
                    </label>
                    <label style="margin-right: 15px;">
                        <input type="radio" name="trendRange" value="3m" onchange="updateTrendChart()"> 3 æœˆ
                    </label>
                    <label style="margin-right: 15px;">
                        <input type="radio" name="trendRange" value="1y" onchange="updateTrendChart()"> 1 å¹´
                    </label>
                    <label>
                        <input type="radio" name="trendRange" value="5y" checked onchange="updateTrendChart()"> 5 å¹´
                    </label>
                </div>
            </div>
            
            <div class="chart-container">
                <canvas id="trendChart"></canvas>
            </div>
            
            <div class="card">
                <h3>é‡è¦å¸‚å ´äº‹ä»¶</h3>
                <table class="table">
                    <thead>
                        <tr>
                            <th>æ—¥æœŸ</th>
                            <th>äº‹ä»¶</th>
                            <th>å½±éŸ¿</th>
                            <th>P/E è®ŠåŒ–</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2024-03-15</td>
                            <td>è¯æº–æœƒåŠ æ¯ 0.25%</td>
                            <td><span class="badge badge-danger">è² é¢</span></td>
                            <td>-2.3%</td>
                        </tr>
                        <tr>
                            <td>2024-07-20</td>
                            <td>ç§‘æŠ€è‚¡è²¡å ±å­£</td>
                            <td><span class="badge badge-success">æ­£é¢</span></td>
                            <td>+5.1%</td>
                        </tr>
                        <tr>
                            <td>2024-11-05</td>
                            <td>ç¾åœ‹å¤§é¸</td>
                            <td><span class="badge badge-warning">ä¸­æ€§</span></td>
                            <td>+1.2%</td>
                        </tr>
                        <tr>
                            <td>2025-01-10</td>
                            <td>AI æŠ€è¡“çªç ´</td>
                            <td><span class="badge badge-success">æ­£é¢</span></td>
                            <td>+8.5%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Alerts Tab -->
        <div id="alerts" class="tab-content">
            <div class="card">
                <h3>ğŸ”” è¨­å®šåƒ¹æ ¼è­¦å ±</h3>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">ç•¶ P/E æ¯”ç‡é”åˆ°ç‰¹å®šæ°´å¹³æ™‚ï¼Œæ‚¨æœƒæ”¶åˆ°é€šçŸ¥ã€‚</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <div class="form-group">
                        <label>æŒ‡æ•¸åç¨±</label>
                        <select id="alertIndex">
                            <option value="sp500">æ¨™æ™® 500</option>
                            <option value="nasdaq">ç´æ–¯é”å…‹</option>
                            <option value="dow">é“ç“Šå·¥æ¥­</option>
                            <option value="hsi">æ’ç”ŸæŒ‡æ•¸</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>è­¦å ±é¡å‹</label>
                        <select id="alertType">
                            <option value="above">é«˜æ–¼</option>
                            <option value="below">ä½æ–¼</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>P/E æ¯”ç‡å€¼</label>
                        <input type="number" id="alertValue" placeholder="ä¾‹å¦‚ï¼š30" step="0.1" min="0">
                    </div>
                </div>
                
                <button class="btn" onclick="addAlert()" style="width: 100%; margin-bottom: 20px;">+ æ·»åŠ è­¦å ±</button>
                
                <div id="alertsList">
                    <!-- å‹•æ…‹æ·»åŠ çš„è­¦å ± -->
                </div>
            </div>
        </div>
        
        <!-- Filter Tab -->
        <div id="filter" class="tab-content">
            <div class="filter-section">
                <h3 style="margin-bottom: 20px;">ğŸ” é«˜ç´šç¯©é¸å·¥å…·</h3>
                
                <div class="filter-group">
                    <div>
                        <label>P/E æ¯”ç‡ç¯„åœ</label>
                        <input type="number" id="filterPEMin" placeholder="æœ€å°å€¼" step="0.1" min="0">
                    </div>
                    <div>
                        <label>è‡³</label>
                        <input type="number" id="filterPEMax" placeholder="æœ€å¤§å€¼" step="0.1" min="0">
                    </div>
                </div>
                
                <div class="filter-group">
                    <div>
                        <label>è¡Œæ¥­</label>
                        <select id="filterIndustry">
                            <option value="">æ‰€æœ‰è¡Œæ¥­</option>
                            <option value="tech">ç§‘æŠ€è‚¡</option>
                            <option value="healthcare">é†«ç™‚ä¿å¥</option>
                            <option value="finance">é‡‘èæœå‹™</option>
                            <option value="manufacturing">è£½é€ æ¥­</option>
                            <option value="energy">èƒ½æº</option>
                        </select>
                    </div>
                    <div>
                        <label>è³‡é‡‘æµå‘</label>
                        <select id="filterFlow">
                            <option value="">æ‰€æœ‰æµå‘</option>
                            <option value="inflow">æ·¨æµå…¥</option>
                            <option value="outflow">æ·¨æµå‡º</option>
                        </select>
                    </div>
                </div>
                
                <div class="filter-group">
                    <div>
                        <label>æŠ€è¡“ä¿¡è™Ÿ</label>
                        <select id="filterSignal">
                            <option value="">æ‰€æœ‰ä¿¡è™Ÿ</option>
                            <option value="bullish">çœ‹æ¼²</option>
                            <option value="bearish">çœ‹è·Œ</option>
                            <option value="neutral">ä¸­æ€§</option>
                        </select>
                    </div>
                </div>
                
                <button class="btn" onclick="applyFilters()" style="width: 100%; margin-bottom: 15px;">ğŸ” æ‡‰ç”¨ç¯©é¸</button>
                <button class="btn" onclick="clearFilters()" style="width: 100%; background-color: #999;">æ¸…é™¤ç¯©é¸</button>
            </div>
            
            <div class="card">
                <h3>ç¯©é¸çµæœ</h3>
                <table class="table">
                    <thead>
                        <tr>
                            <th>è‚¡ç¥¨ä»£ç¢¼</th>
                            <th>è¡Œæ¥­</th>
                            <th>P/E æ¯”ç‡</th>
                            <th>è³‡é‡‘æµå‘</th>
                            <th>æŠ€è¡“ä¿¡è™Ÿ</th>
                            <th>è©•åˆ†</th>
                        </tr>
                    </thead>
                    <tbody id="filterResults">
                        <tr>
                            <td colspan="6" style="text-align: center; color: var(--text-secondary);">é»æ“Šã€Œæ‡‰ç”¨ç¯©é¸ã€æŸ¥çœ‹çµæœ</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Compare Tab -->
        <div id="compare" class="tab-content">
            <div class="card">
                <h3>âš–ï¸ æ•¸æ“šå°æ¯”å·¥å…·</h3>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">åŒæ™‚å°æ¯”å¤šå€‹è‚¡ç¥¨æˆ–æŒ‡æ•¸çš„ P/E æ¯”ç‡å’Œå…¶ä»–æŒ‡æ¨™ã€‚</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <div class="form-group">
                        <label>è‚¡ç¥¨ä»£ç¢¼ 1</label>
                        <input type="text" id="compareSymbol1" placeholder="ä¾‹å¦‚ï¼šAAPL">
                    </div>
                    <div class="form-group">
                        <label>è‚¡ç¥¨ä»£ç¢¼ 2</label>
                        <input type="text" id="compareSymbol2" placeholder="ä¾‹å¦‚ï¼šMSFT">
                    </div>
                    <div class="form-group">
                        <label>è‚¡ç¥¨ä»£ç¢¼ 3</label>
                        <input type="text" id="compareSymbol3" placeholder="ä¾‹å¦‚ï¼šGOOGL">
                    </div>
                </div>
                
                <button class="btn" onclick="performComparison()" style="width: 100%; margin-bottom: 20px;">âš–ï¸ åŸ·è¡Œå°æ¯”</button>
                
                <div class="chart-container">
                    <canvas id="compareChart"></canvas>
                </div>
            </div>
            
            <div class="card">
                <h3>å°æ¯”è©³æƒ…</h3>
                <table class="table" id="compareTable">
                    <thead>
                        <tr>
                            <th>æŒ‡æ¨™</th>
                            <th id="compareHeader1">è‚¡ç¥¨ 1</th>
                            <th id="compareHeader2">è‚¡ç¥¨ 2</th>
                            <th id="compareHeader3">è‚¡ç¥¨ 3</th>
                        </tr>
                    </thead>
                    <tbody id="compareTableBody">
                        <tr>
                            <td colspan="4" style="text-align: center; color: var(--text-secondary);">é»æ“Šã€ŒåŸ·è¡Œå°æ¯”ã€æŸ¥çœ‹è©³æƒ…</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- AI Recommendations Tab -->
        <div id="ai" class="tab-content">
            <div class="card">
                <h3>ğŸ¤– AI æŠ•è³‡å»ºè­°</h3>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">åŸºæ–¼ P/E æ¯”ç‡ã€è³‡é‡‘æµå‘å’ŒæŠ€è¡“æŒ‡æ¨™çš„æ™ºèƒ½æ¨è–¦ã€‚</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px;">
                    <div class="ai-recommendation">
                        <h4>æ¨™æ™® 500 è©•ä¼°</h4>
                        <div class="ai-score">6.2/10</div>
                        <div>
                            <strong>è©•ç´šï¼š</strong> æŒæœ‰ âš ï¸
                        </div>
                        <div style="margin-top: 10px; font-size: 0.9em;">
                            <div>âœ“ æŠ€è¡“é¢å‘ä¸Š</div>
                            <div>âœ— P/E æ¯”ç‡éé«˜</div>
                            <div>âœ“ è³‡é‡‘æµå…¥ç©©å®š</div>
                        </div>
                    </div>
                    
                    <div class="ai-recommendation" style="background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);">
                        <h4>æ’ç”ŸæŒ‡æ•¸è©•ä¼°</h4>
                        <div class="ai-score">7.8/10</div>
                        <div>
                            <strong>è©•ç´šï¼š</strong> è²·é€² âœ…
                        </div>
                        <div style="margin-top: 10px; font-size: 0.9em;">
                            <div>âœ“ P/E æ¯”ç‡ä½ä¼°</div>
                            <div>âœ“ è³‡é‡‘é–‹å§‹æµå…¥</div>
                            <div>âœ“ æŠ€è¡“é¢æ”¹å–„</div>
                        </div>
                    </div>
                    
                    <div class="ai-recommendation" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                        <h4>è£½é€ æ¥­è©•ä¼°</h4>
                        <div class="ai-score">3.5/10</div>
                        <div>
                            <strong>è©•ç´šï¼š</strong> è³£å‡º âŒ
                        </div>
                        <div style="margin-top: 10px; font-size: 0.9em;">
                            <div>âœ— è³‡é‡‘å¤§å¹…æµå‡º</div>
                            <div>âœ— æŠ€è¡“é¢çœ‹è·Œ</div>
                            <div>âœ— å¢é•·å‰æ™¯æš—æ·¡</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>æ¨è–¦æŠ•è³‡çµ„åˆé…ç½®</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <div style="background: var(--bg-secondary); padding: 15px; border-radius: 5px; text-align: center;">
                        <div style="font-size: 1.5em; font-weight: bold; color: #667eea;">60%</div>
                        <div>ç§‘æŠ€è‚¡ + å‰µæ–°</div>
                        <div style="font-size: 0.85em; color: var(--text-secondary); margin-top: 5px;">é«˜å¢é•·æ½›åŠ›</div>
                    </div>
                    <div style="background: var(--bg-secondary); padding: 15px; border-radius: 5px; text-align: center;">
                        <div style="font-size: 1.5em; font-weight: bold; color: #22c55e;">25%</div>
                        <div>é˜²ç¦¦æ€§è‚¡ç¥¨</div>
                        <div style="font-size: 0.85em; color: var(--text-secondary); margin-top: 5px;">é¢¨éšªå°æ²–</div>
                    </div>
                    <div style="background: var(--bg-secondary); padding: 15px; border-radius: 5px; text-align: center;">
                        <div style="font-size: 1.5em; font-weight: bold; color: #f97316;">15%</div>
                        <div>æ–°èˆˆå¸‚å ´</div>
                        <div style="font-size: 0.85em; color: var(--text-secondary); margin-top: 5px;">åœ°åŸŸåˆ†æ•£</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Advanced Tab -->
        <div id="advanced" class="tab-content">
            <div class="card">
                <h3>â­ é€²éšåŠŸèƒ½</h3>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; border: 1px solid var(--border-color);">
                        <h4 style="color: var(--primary-color); margin-bottom: 10px;">ğŸ“Š è¡Œæ¥­å°æ¯”åˆ†æ</h4>
                        <p style="color: var(--text-secondary); font-size: 0.9em;">åŒæ™‚æŸ¥çœ‹å¤šå€‹è¡Œæ¥­çš„ P/E æ¯”ç‡ã€å¢é•·ç‡å’Œé¢¨éšªè©•åˆ†ã€‚</p>
                        <button class="btn" onclick="showIndustryComparison()" style="width: 100%; margin-top: 10px;">æŸ¥çœ‹è©³æƒ…</button>
                    </div>
                    
                    <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; border: 1px solid var(--border-color);">
                        <h4 style="color: var(--primary-color); margin-bottom: 10px;">ğŸ’° æ”¶ç›Šç‡è¨ˆç®—å™¨</h4>
                        <p style="color: var(--text-secondary); font-size: 0.9em;">è¨ˆç®—é æœŸæ”¶ç›Šç‡ã€è‚¡æ¯æ”¶ç›Šç‡å’Œç¸½å›å ±ç‡ã€‚</p>
                        <button class="btn" onclick="showYieldCalculator()" style="width: 100%; margin-top: 10px;">è¨ˆç®—</button>
                    </div>
                    
                    <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; border: 1px solid var(--border-color);">
                        <h4 style="color: var(--primary-color); margin-bottom: 10px;">ğŸ“ˆ é¢¨éšªè©•ä¼°å·¥å…·</h4>
                        <p style="color: var(--text-secondary); font-size: 0.9em;">è©•ä¼°æ‚¨çš„æŠ•è³‡çµ„åˆé¢¨éšªç­‰ç´šå’Œæ³¢å‹•æ€§ã€‚</p>
                        <button class="btn" onclick="showRiskAssessment()" style="width: 100%; margin-top: 10px;">è©•ä¼°</button>
                    </div>
                </div>
            </div>
            
            <div id="industryComparisonModal" class="modal">
                <div class="modal-content">
                    <span class="modal-close" onclick="closeModal('industryComparisonModal')">&times;</span>
                    <h3>è¡Œæ¥­å°æ¯”åˆ†æ</h3>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>è¡Œæ¥­</th>
                                <th>å¹³å‡ P/E</th>
                                <th>å¢é•·ç‡</th>
                                <th>é¢¨éšªè©•åˆ†</th>
                                <th>æ¨è–¦</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ç§‘æŠ€è‚¡</td>
                                <td>35.2</td>
                                <td>+12.5%</td>
                                <td><span class="badge badge-danger">é«˜</span></td>
                                <td>æŒæœ‰</td>
                            </tr>
                            <tr>
                                <td>é†«ç™‚ä¿å¥</td>
                                <td>18.5</td>
                                <td>+8.2%</td>
                                <td><span class="badge badge-warning">ä¸­</span></td>
                                <td>è²·é€²</td>
                            </tr>
                            <tr>
                                <td>é‡‘èæœå‹™</td>
                                <td>12.3</td>
                                <td>+3.1%</td>
                                <td><span class="badge badge-success">ä½</span></td>
                                <td>æŒæœ‰</td>
                            </tr>
                            <tr>
                                <td>è£½é€ æ¥­</td>
                                <td>14.8</td>
                                <td>-2.5%</td>
                                <td><span class="badge badge-danger">é«˜</span></td>
                                <td>è³£å‡º</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div id="yieldCalculatorModal" class="modal">
                <div class="modal-content">
                    <span class="modal-close" onclick="closeModal('yieldCalculatorModal')">&times;</span>
                    <h3>æ”¶ç›Šç‡è¨ˆç®—å™¨</h3>
                    <div class="form-group">
                        <label>è‚¡ç¥¨ä»£ç¢¼</label>
                        <input type="text" id="yieldSymbol" placeholder="ä¾‹å¦‚ï¼šAAPL">
                    </div>
                    <div class="form-group">
                        <label>ç•¶å‰è‚¡åƒ¹ ($)</label>
                        <input type="number" id="yieldPrice" placeholder="ä¾‹å¦‚ï¼š150.25" step="0.01" min="0">
                    </div>
                    <div class="form-group">
                        <label>å¹´åº¦è‚¡æ¯ ($)</label>
                        <input type="number" id="yieldDividend" placeholder="ä¾‹å¦‚ï¼š0.92" step="0.01" min="0">
                    </div>
                    <div class="form-group">
                        <label>é æœŸå¢é•·ç‡ (%)</label>
                        <input type="number" id="yieldGrowth" placeholder="ä¾‹å¦‚ï¼š8.5" step="0.1" min="0">
                    </div>
                    <button class="btn" onclick="calculateYield()" style="width: 100%;">è¨ˆç®—æ”¶ç›Šç‡</button>
                    <div id="yieldResult" style="margin-top: 20px;"></div>
                </div>
            </div>
            
            <div id="riskAssessmentModal" class="modal">
                <div class="modal-content">
                    <span class="modal-close" onclick="closeModal('riskAssessmentModal')">&times;</span>
                    <h3>é¢¨éšªè©•ä¼°å·¥å…·</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 20px;">åŸºæ–¼æ‚¨çš„æŠ•è³‡çµ„åˆé€²è¡Œé¢¨éšªè©•ä¼°ã€‚</p>
                    <div class="result-box">
                        <h4>æ‚¨çš„æŠ•è³‡çµ„åˆé¢¨éšªè©•åˆ†</h4>
                        <div style="font-size: 2em; font-weight: bold; color: #667eea; margin: 15px 0;">6.5/10</div>
                        <div style="margin-bottom: 15px;">
                            <strong>é¢¨éšªç­‰ç´šï¼š</strong> ä¸­ç­‰é¢¨éšª
                        </div>
                        <div>
                            <strong>è©³ç´°åˆ†æï¼š</strong>
                            <ul style="margin-top: 10px; margin-left: 20px;">
                                <li>æ³¢å‹•æ€§ï¼šä¸­ç­‰ (æ¨™æº–å·® 18.5%)</li>
                                <li>è¡Œæ¥­åˆ†æ•£åº¦ï¼šè‰¯å¥½ (5 å€‹è¡Œæ¥­)</li>
                                <li>P/E æ¯”ç‡é›†ä¸­åº¦ï¼šä¸­ç­‰ (å¹³å‡ 25.3)</li>
                                <li>æ¨è–¦èª¿æ•´ï¼šå¢åŠ é˜²ç¦¦æ€§è‚¡ç¥¨æ¯”ä¾‹</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>Â© 2025 å°ˆæ¥­æœ¬ç›Šæ¯”åˆ†æå¹³å°ã€‚æ‰€æœ‰æ•¸æ“šåƒ…ä¾›åƒè€ƒï¼Œä¸æ§‹æˆæŠ•è³‡å»ºè­°ã€‚æŠ•è³‡å‰è«‹è«®è©¢å°ˆæ¥­è²¡å‹™é¡§å•ã€‚</p>
        </div>
    </div>
    
    <script>
        // èªè¨€é…ç½®
        const translations = {
            'zh-TW': {
                title: 'å°ˆæ¥­æœ¬ç›Šæ¯”åˆ†æå¹³å°',
                subtitle: 'Professional P/E Ratio Analysis Platform',
                author: 'ä½œè€…ï¼šAI é‡‘èåˆ†æå¸«',
                date: 'ç™¼å¸ƒæ—¥æœŸï¼š2025å¹´11æœˆ6æ—¥',
                source: 'æ•¸æ“šä¾†æºï¼šå¤šé‡æ¬Šå¨é‡‘èæ•¸æ“šæä¾›å•†'
            },
            'en': {
                title: 'Professional P/E Ratio Analysis Platform',
                subtitle: 'Advanced Investment Analysis Tools',
                author: 'Author: AI Financial Analyst',
                date: 'Published: November 6, 2025',
                source: 'Data Source: Multiple Authoritative Financial Data Providers'
            },
            'zh-CN': {
                title: 'ä¸“ä¸šæœ¬ç›Šæ¯”åˆ†æå¹³å°',
                subtitle: 'Professional P/E Ratio Analysis Platform',
                author: 'ä½œè€…ï¼šAI é‡‘èåˆ†æå¸ˆ',
                date: 'å‘å¸ƒæ—¥æœŸï¼š2025å¹´11æœˆ6æ—¥',
                source: 'æ•°æ®æ¥æºï¼šå¤šé‡æƒå¨é‡‘èæ•°æ®æä¾›å•†'
            }
        };
        
        let currentLanguage = 'zh-TW';
        let isDarkMode = localStorage.getItem('darkMode') === 'true';
        let portfolioData = JSON.parse(localStorage.getItem('portfolio')) || [];
        let alertsData = JSON.parse(localStorage.getItem('alerts')) || [];
        let dashboardWidgets = JSON.parse(localStorage.getItem('dashboardWidgets')) || ['pe-overview', 'sentiment-us'];
        
        // åˆå§‹åŒ–
        if (isDarkMode) {
            document.body.classList.add('dark-mode');
        }
        
        loadPortfolio();
        loadAlerts();
        loadDashboard();
        updateLanguage();
        initTrendChart();
        initCompareChart();
        
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('darkMode', isDarkMode);
        }
        
        function changeLanguage(lang) {
            currentLanguage = lang;
            updateLanguage();
        }
        
        function updateLanguage() {
            const trans = translations[currentLanguage];
            document.getElementById('title').textContent = trans.title;
            document.getElementById('subtitle').textContent = trans.subtitle;
            document.getElementById('author').textContent = trans.author;
            document.getElementById('date').textContent = trans.date;
            document.getElementById('source').textContent = trans.source;
        }
        
        function switchTab(event, tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            const buttons = document.querySelectorAll('.tab-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }
        
        // æŠ•è³‡çµ„åˆåŠŸèƒ½
        function addPortfolioItem() {
            const symbol = document.getElementById('portfolioSymbol').value.toUpperCase();
            const shares = parseFloat(document.getElementById('portfolioShares').value);
            const cost = parseFloat(document.getElementById('portfolioCost').value);
            const price = parseFloat(document.getElementById('portfolioPrice').value);
            
            if (!symbol || !shares || !cost || !price) {
                alert('è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½');
                return;
            }
            
            portfolioData.push({
                symbol, shares, cost, price,
                totalCost: shares * cost,
                totalValue: shares * price,
                gain: (shares * price) - (shares * cost),
                gainPercent: ((price - cost) / cost * 100).toFixed(2)
            });
            
            localStorage.setItem('portfolio', JSON.stringify(portfolioData));
            document.getElementById('portfolioSymbol').value = '';
            document.getElementById('portfolioShares').value = '';
            document.getElementById('portfolioCost').value = '';
            document.getElementById('portfolioPrice').value = '';
            
            loadPortfolio();
        }
        
        function removePortfolioItem(index) {
            portfolioData.splice(index, 1);
            localStorage.setItem('portfolio', JSON.stringify(portfolioData));
            loadPortfolio();
        }
        
        function loadPortfolio() {
            const container = document.getElementById('portfolioItems');
            
            if (portfolioData.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: var(--text-secondary); padding: 20px;">é‚„æ²’æœ‰æ·»åŠ ä»»ä½•è‚¡ç¥¨ã€‚é–‹å§‹æ§‹å»ºæ‚¨çš„æŠ•è³‡çµ„åˆï¼</div>';
                updatePortfolioAnalysis();
                return;
            }
            
            container.innerHTML = portfolioData.map((item, index) => `
                <div class="portfolio-item">
                    <div>
                        <strong>${item.symbol}</strong> - ${item.shares} è‚¡
                        <div style="font-size: 0.9em; color: var(--text-secondary);">
                            æˆæœ¬: $${item.totalCost.toFixed(2)} | ç•¶å‰: $${item.totalValue.toFixed(2)}
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-weight: bold; color: ${item.gain >= 0 ? '#22c55e' : '#ef4444'};">
                            ${item.gain >= 0 ? '+' : ''}$${item.gain.toFixed(2)}
                        </div>
                        <div style="font-size: 0.9em; color: ${item.gainPercent >= 0 ? '#22c55e' : '#ef4444'};">
                            ${item.gainPercent >= 0 ? '+' : ''}${item.gainPercent}%
                        </div>
                        <button class="portfolio-item-remove" onclick="removePortfolioItem(${index})">ç§»é™¤</button>
                    </div>
                </div>
            `).join('');
            
            updatePortfolioAnalysis();
        }
        
        function updatePortfolioAnalysis() {
            const container = document.getElementById('portfolioAnalysis');
            
            if (portfolioData.length === 0) {
                container.innerHTML = '<div style="grid-column: 1/-1; text-align: center; color: var(--text-secondary);">æ·»åŠ è‚¡ç¥¨å¾Œæœƒé¡¯ç¤ºåˆ†æ</div>';
                return;
            }
            
            const totalCost = portfolioData.reduce((sum, item) => sum + item.totalCost, 0);
            const totalValue = portfolioData.reduce((sum, item) => sum + item.totalValue, 0);
            const totalGain = totalValue - totalCost;
            const totalGainPercent = (totalGain / totalCost * 100).toFixed(2);
            const avgPE = (portfolioData.reduce((sum, item) => sum + 28.5, 0) / portfolioData.length).toFixed(2);
            
            container.innerHTML = `
                <div class="card">
                    <h4>ç¸½æŠ•è³‡æˆæœ¬</h4>
                    <div style="font-size: 1.8em; font-weight: bold; color: #667eea;">$${totalCost.toFixed(2)}</div>
                </div>
                <div class="card">
                    <h4>ç•¶å‰æŠ•è³‡åƒ¹å€¼</h4>
                    <div style="font-size: 1.8em; font-weight: bold; color: #764ba2;">$${totalValue.toFixed(2)}</div>
                </div>
                <div class="card">
                    <h4>ç¸½æ”¶ç›Š</h4>
                    <div style="font-size: 1.8em; font-weight: bold; color: ${totalGain >= 0 ? '#22c55e' : '#ef4444'};">
                        ${totalGain >= 0 ? '+' : ''}$${totalGain.toFixed(2)}
                    </div>
                    <div style="font-size: 1.2em; color: ${totalGainPercent >= 0 ? '#22c55e' : '#ef4444'};">
                        ${totalGainPercent >= 0 ? '+' : ''}${totalGainPercent}%
                    </div>
                </div>
                <div class="card">
                    <h4>å¹³å‡ P/E æ¯”ç‡</h4>
                    <div style="font-size: 1.8em; font-weight: bold; color: #f97316;">${avgPE}</div>
                </div>
            `;
        }
        
        // è­¦å ±åŠŸèƒ½
        function addAlert() {
            const index = document.getElementById('alertIndex').value;
            const type = document.getElementById('alertType').value;
            const value = parseFloat(document.getElementById('alertValue').value);
            
            if (!value) {
                alert('è«‹è¼¸å…¥ P/E æ¯”ç‡å€¼');
                return;
            }
            
            alertsData.push({
                index, type, value,
                createdDate: new Date().toLocaleDateString('zh-TW'),
                triggered: false
            });
            
            localStorage.setItem('alerts', JSON.stringify(alertsData));
            document.getElementById('alertValue').value = '';
            loadAlerts();
        }
        
        function removeAlert(index) {
            alertsData.splice(index, 1);
            localStorage.setItem('alerts', JSON.stringify(alertsData));
            loadAlerts();
        }
        
        function loadAlerts() {
            const container = document.getElementById('alertsList');
            
            if (alertsData.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: var(--text-secondary); padding: 20px;">é‚„æ²’æœ‰è¨­å®šä»»ä½•è­¦å ±ã€‚</div>';
                return;
            }
            
            const indexNames = { 'sp500': 'æ¨™æ™® 500', 'nasdaq': 'ç´æ–¯é”å…‹', 'dow': 'é“ç“Šå·¥æ¥­', 'hsi': 'æ’ç”ŸæŒ‡æ•¸' };
            
            container.innerHTML = alertsData.map((alert, index) => `
                <div class="alert-item">
                    <div>
                        <strong>${indexNames[alert.index]}</strong>
                        <div style="font-size: 0.9em; color: var(--text-secondary);">
                            ${alert.type === 'above' ? 'é«˜æ–¼' : 'ä½æ–¼'} ${alert.value} | å‰µå»ºæ–¼ ${alert.createdDate}
                        </div>
                    </div>
                    <button class="alert-item-remove" onclick="removeAlert(${index})">ç§»é™¤</button>
                </div>
            `).join('');
        }
        
        // ç¯©é¸åŠŸèƒ½
        function applyFilters() {
            const peMin = parseFloat(document.getElementById('filterPEMin').value) || 0;
            const peMax = parseFloat(document.getElementById('filterPEMax').value) || 100;
            const industry = document.getElementById('filterIndustry').value;
            const flow = document.getElementById('filterFlow').value;
            const signal = document.getElementById('filterSignal').value;
            
            const allData = [
                { symbol: 'AAPL', industry: 'tech', pe: 28.5, flow: 'inflow', signal: 'bullish', score: 8.5 },
                { symbol: 'MSFT', industry: 'tech', pe: 32.1, flow: 'inflow', signal: 'bullish', score: 8.2 },
                { symbol: 'JNJ', industry: 'healthcare', pe: 18.5, flow: 'inflow', signal: 'neutral', score: 7.8 },
                { symbol: 'JPM', industry: 'finance', pe: 12.3, flow: 'outflow', signal: 'bearish', score: 5.2 },
                { symbol: 'GE', industry: 'manufacturing', pe: 14.8, flow: 'outflow', signal: 'bearish', score: 3.5 },
            ];
            
            const filtered = allData.filter(item => 
                item.pe >= peMin && item.pe <= peMax &&
                (!industry || item.industry === industry) &&
                (!flow || item.flow === flow) &&
                (!signal || item.signal === signal)
            );
            
            const tbody = document.getElementById('filterResults');
            if (filtered.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center;">æ²’æœ‰ç¬¦åˆæ¢ä»¶çš„çµæœ</td></tr>';
                return;
            }
            
            tbody.innerHTML = filtered.map(item => `
                <tr>
                    <td><strong>${item.symbol}</strong></td>
                    <td>${item.industry}</td>
                    <td>${item.pe}</td>
                    <td><span class="badge ${item.flow === 'inflow' ? 'badge-success' : 'badge-danger'}">${item.flow === 'inflow' ? 'æ·¨æµå…¥' : 'æ·¨æµå‡º'}</span></td>
                    <td><span class="badge ${item.signal === 'bullish' ? 'badge-success' : item.signal === 'bearish' ? 'badge-danger' : 'badge-warning'}">${item.signal === 'bullish' ? 'çœ‹æ¼²' : item.signal === 'bearish' ? 'çœ‹è·Œ' : 'ä¸­æ€§'}</span></td>
                    <td><strong>${item.score}/10</strong></td>
                </tr>
            `).join('');
        }
        
        function clearFilters() {
            document.getElementById('filterPEMin').value = '';
            document.getElementById('filterPEMax').value = '';
            document.getElementById('filterIndustry').value = '';
            document.getElementById('filterFlow').value = '';
            document.getElementById('filterSignal').value = '';
            document.getElementById('filterResults').innerHTML = '<tr><td colspan="6" style="text-align: center; color: var(--text-secondary);">é»æ“Šã€Œæ‡‰ç”¨ç¯©é¸ã€æŸ¥çœ‹çµæœ</td></tr>';
        }
        
        // å°æ¯”åŠŸèƒ½
        let compareChart;
        
        function initCompareChart() {
            const ctx = document.getElementById('compareChart');
            if (!ctx) return;
            
            compareChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['P/E æ¯”ç‡', 'è³‡é‡‘æµå‘ ($B)', 'æŠ€è¡“ä¿¡è™Ÿ'],
                    datasets: []
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top' },
                        title: { display: true, text: 'è‚¡ç¥¨å°æ¯”åˆ†æ' }
                    },
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
        }
        
        function performComparison() {
            const symbol1 = document.getElementById('compareSymbol1').value.toUpperCase() || 'è‚¡ç¥¨ 1';
            const symbol2 = document.getElementById('compareSymbol2').value.toUpperCase() || 'è‚¡ç¥¨ 2';
            const symbol3 = document.getElementById('compareSymbol3').value.toUpperCase() || 'è‚¡ç¥¨ 3';
            
            const mockData = {
                'AAPL': { pe: 28.5, flow: 2.1, signal: 8.5, rating: 'è²·é€²' },
                'MSFT': { pe: 32.1, flow: 1.8, signal: 8.2, rating: 'è²·é€²' },
                'GOOGL': { pe: 24.3, flow: 1.5, signal: 7.8, rating: 'æŒæœ‰' },
                'TSLA': { pe: 45.2, flow: 0.9, signal: 6.5, rating: 'æŒæœ‰' },
                'AMZN': { pe: 35.8, flow: 1.2, signal: 7.2, rating: 'æŒæœ‰' },
                '2800': { pe: 9.2, flow: 0.8, signal: 7.0, rating: 'è²·é€²' }
            };
            
            const data1 = mockData[symbol1] || { pe: 25, flow: 1.5, signal: 7, rating: 'æŒæœ‰' };
            const data2 = mockData[symbol2] || { pe: 28, flow: 1.8, signal: 7.5, rating: 'æŒæœ‰' };
            const data3 = mockData[symbol3] || { pe: 30, flow: 2.0, signal: 8, rating: 'è²·é€²' };
            
            if (compareChart) {
                compareChart.data.datasets = [
                    {
                        label: symbol1,
                        data: [data1.pe, data1.flow * 10, data1.signal * 5],
                        backgroundColor: '#667eea'
                    },
                    {
                        label: symbol2,
                        data: [data2.pe, data2.flow * 10, data2.signal * 5],
                        backgroundColor: '#764ba2'
                    },
                    {
                        label: symbol3,
                        data: [data3.pe, data3.flow * 10, data3.signal * 5],
                        backgroundColor: '#22c55e'
                    }
                ];
                compareChart.update();
            }
            
            const tbody = document.getElementById('compareTableBody');
            tbody.innerHTML = `
                <tr>
                    <td><strong>P/E æ¯”ç‡</strong></td>
                    <td>${data1.pe}</td>
                    <td>${data2.pe}</td>
                    <td>${data3.pe}</td>
                </tr>
                <tr>
                    <td><strong>è³‡é‡‘æµå‘ ($B)</strong></td>
                    <td>${data1.flow}</td>
                    <td>${data2.flow}</td>
                    <td>${data3.flow}</td>
                </tr>
                <tr>
                    <td><strong>æŠ€è¡“ä¿¡è™Ÿè©•åˆ†</strong></td>
                    <td>${data1.signal}/10</td>
                    <td>${data2.signal}/10</td>
                    <td>${data3.signal}/10</td>
                </tr>
                <tr>
                    <td><strong>æ¨è–¦è©•ç´š</strong></td>
                    <td><span class="badge ${data1.rating === 'è²·é€²' ? 'badge-success' : 'badge-warning'}">${data1.rating}</span></td>
                    <td><span class="badge ${data2.rating === 'è²·é€²' ? 'badge-success' : 'badge-warning'}">${data2.rating}</span></td>
                    <td><span class="badge ${data3.rating === 'è²·é€²' ? 'badge-success' : 'badge-warning'}">${data3.rating}</span></td>
                </tr>
            `;
            
            document.getElementById('compareHeader1').textContent = symbol1;
            document.getElementById('compareHeader2').textContent = symbol2;
            document.getElementById('compareHeader3').textContent = symbol3;
        }
        
        // è¶¨å‹¢åœ–è¡¨ - å¤šæŒ‡æ•¸
        let trendChart;
        
        function initTrendChart() {
            const ctx = document.getElementById('trendChart');
            if (!ctx) return;
            
            trendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['2020-01', '2020-06', '2021-01', '2021-06', '2022-01', '2022-06', '2023-01', '2023-06', '2024-01', '2024-06', '2025-01', '2025-06'],
                    datasets: [
                        {
                            label: 'æ¨™æ™® 500',
                            data: [18.5, 19.2, 21.5, 23.1, 19.8, 17.2, 20.5, 24.3, 26.1, 27.8, 28.5, 28.5],
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'ç´æ–¯é”å…‹',
                            data: [28.2, 29.1, 32.5, 35.1, 29.8, 27.2, 30.5, 34.3, 36.1, 37.8, 35.2, 35.2],
                            borderColor: '#764ba2',
                            backgroundColor: 'rgba(118, 75, 162, 0.1)',
                            tension: 0.4,
                            fill: false
                        },
                        {
                            label: 'é“ç“Šå·¥æ¥­',
                            data: [16.5, 17.2, 19.5, 21.1, 17.8, 15.2, 18.5, 22.3, 24.1, 25.8, 26.8, 26.8],
                            borderColor: '#22c55e',
                            backgroundColor: 'rgba(34, 197, 94, 0.1)',
                            tension: 0.4,
                            fill: false
                        },
                        {
                            label: 'æ’ç”ŸæŒ‡æ•¸',
                            data: [10.5, 10.8, 11.5, 10.1, 9.8, 8.2, 8.5, 9.3, 9.1, 9.5, 9.2, 9.2],
                            borderColor: '#f97316',
                            backgroundColor: 'rgba(249, 115, 22, 0.1)',
                            tension: 0.4,
                            fill: false
                        },
                        {
                            label: 'æ­·å²å¹³å‡',
                            data: [16.8, 16.8, 16.8, 16.8, 16.8, 16.8, 16.8, 16.8, 16.8, 16.8, 16.8, 16.8],
                            borderColor: '#999',
                            borderDash: [5, 5],
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top' },
                        title: { display: true, text: 'P/E æ¯”ç‡ 5 å¹´è¶¨å‹¢ (å¤šæŒ‡æ•¸)' }
                    }
                }
            });
        }
        
        function updateTrendChart() {
            const range = document.querySelector('input[name="trendRange"]:checked').value;
            alert('å·²åˆ‡æ›åˆ° ' + (range === '1m' ? '1 æœˆ' : range === '3m' ? '3 æœˆ' : range === '1y' ? '1 å¹´' : '5 å¹´') + ' è¦–åœ–');
        }
        
        // å„€è¡¨æ¿åŠŸèƒ½
        function addWidget(widgetType) {
            if (!dashboardWidgets.includes(widgetType)) {
                dashboardWidgets.push(widgetType);
                localStorage.setItem('dashboardWidgets', JSON.stringify(dashboardWidgets));
                loadDashboard();
            }
        }
        
        function removeWidget(widgetType) {
            dashboardWidgets = dashboardWidgets.filter(w => w !== widgetType);
            localStorage.setItem('dashboardWidgets', JSON.stringify(dashboardWidgets));
            loadDashboard();
        }
        
        function loadDashboard() {
            const container = document.getElementById('dashboardWidgets');
            
            const widgetContent = {
                'pe-overview': '<h4>P/E ç¸½è¦½</h4><div style="font-size: 1.5em; font-weight: bold; color: #667eea; margin: 10px 0;">28.5</div><div style="font-size: 0.9em; color: var(--text-secondary);">æ¨™æ™® 500 P/E æ¯”ç‡</div>',
                'sentiment-us': '<h4>ç¾åœ‹å¸‚å ´æƒ…ç·’</h4><div style="font-size: 1.5em; font-weight: bold; color: #f97316; margin: 10px 0;">35</div><div style="font-size: 0.9em; color: var(--text-secondary);">ææ‡¼æŒ‡æ•¸</div>',
                'sentiment-hk': '<h4>é¦™æ¸¯å¸‚å ´æƒ…ç·’</h4><div style="font-size: 1.5em; font-weight: bold; color: #22c55e; margin: 10px 0;">62</div><div style="font-size: 0.9em; color: var(--text-secondary);">è²ªå©ªæŒ‡æ•¸</div>',
                'hot-sectors-us': '<h4>ç¾è‚¡ç†±é»æ¿å¡Š</h4><div style="font-size: 1.2em; margin: 10px 0;">ğŸš€ ç§‘æŠ€è‚¡ +8.5%</div><div style="font-size: 0.9em; color: var(--text-secondary);">æœ¬é€±è¡¨ç¾æœ€å¼·</div>',
                'hot-sectors-hk': '<h4>æ¸¯è‚¡ç†±é»æ¿å¡Š</h4><div style="font-size: 1.2em; margin: 10px 0;">ğŸ“ˆ é‡‘èè‚¡ +5.2%</div><div style="font-size: 0.9em; color: var(--text-secondary);">æœ¬é€±è¡¨ç¾æœ€å¼·</div>',
                'portfolio-summary': '<h4>çµ„åˆæ‘˜è¦</h4><div style="font-size: 1.5em; font-weight: bold; color: #22c55e; margin: 10px 0;">+$2,450</div><div style="font-size: 0.9em; color: var(--text-secondary);">ç¸½æ”¶ç›Š</div>'
            };
            
            container.innerHTML = dashboardWidgets.map(widget => `
                <div class="dashboard-widget">
                    <div class="dashboard-widget-header">
                        <div class="dashboard-widget-title"></div>
                        <button class="dashboard-widget-remove" onclick="removeWidget('${widget}')">âœ•</button>
                    </div>
                    ${widgetContent[widget] || ''}
                </div>
            `).join('');
        }
        
        // é€²éšåŠŸèƒ½ - Modal
        function showIndustryComparison() {
            document.getElementById('industryComparisonModal').style.display = 'block';
        }
        
        function showYieldCalculator() {
            document.getElementById('yieldCalculatorModal').style.display = 'block';
        }
        
        function showRiskAssessment() {
            document.getElementById('riskAssessmentModal').style.display = 'block';
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        function calculateYield() {
            const symbol = document.getElementById('yieldSymbol').value;
            const price = parseFloat(document.getElementById('yieldPrice').value);
            const dividend = parseFloat(document.getElementById('yieldDividend').value);
            const growth = parseFloat(document.getElementById('yieldGrowth').value);
            
            if (!price || !dividend || !growth) {
                alert('è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½');
                return;
            }
            
            const dividendYield = (dividend / price * 100).toFixed(2);
            const totalReturn = (dividendYield + growth).toFixed(2);
            
            document.getElementById('yieldResult').innerHTML = `
                <div class="result-box">
                    <h4>${symbol} æ”¶ç›Šç‡åˆ†æ</h4>
                    <div style="margin-top: 15px;">
                        <div style="margin-bottom: 10px;">
                            <strong>è‚¡æ¯æ”¶ç›Šç‡ï¼š</strong> ${dividendYield}%
                        </div>
                        <div style="margin-bottom: 10px;">
                            <strong>é æœŸå¢é•·ç‡ï¼š</strong> ${growth}%
                        </div>
                        <div style="font-size: 1.3em; font-weight: bold; color: #667eea; margin-top: 15px;">
                            é æœŸç¸½å›å ±ç‡ï¼š${totalReturn}%
                        </div>
                    </div>
                </div>
            `;
        }
        
        // å°å‡ºåŠŸèƒ½
        function exportPDF() {
            alert('PDF å°å‡ºåŠŸèƒ½å·²æº–å‚™å¥½');
        }
        
        function exportCSV() {
            alert('CSV å°å‡ºåŠŸèƒ½å·²æº–å‚™å¥½');
        }
        
        // é—œé–‰ modal ç•¶é»æ“Šå¤–éƒ¨æ™‚
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>
